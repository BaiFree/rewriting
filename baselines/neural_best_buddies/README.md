## Neural best buddies baseline

To get this baseline, we first compute correspondences between clean images and a pre-edited target image, then use blending techniques to "copy and paste" pixels onto the clean images.

To do the former task, we use `neural_best_buddies/main.py`. `--source` specifies a source set of clean images, `--target` specifies the path to pre-edit target image, `--imgnum` specifies the imgnum **batch**. For example, if a batch size is 100, imgnum 5 would specify `neural_best_buddies/main.py` to generate images 500-600, where the images are numbered according to the numeric value of the imgnum used to generate the image (lowest imgnum is numbered 0). `--k_final 10 --k_per_level 10 --fast` are fields used to make the neural-best-buddies algorithm faster (this process for 50k images is quite slow). 

`--results_dir` specifies the results directory. `{results_dir}/{imgnum}/` specifies the correspondences found for the sample generated by `imgnum` (not the ranked numeric value, but the one that was used by `zdataset.z_sample_for_model`). Of most use is `{results_dir}/{imgnum}/BtoA.npy`, which is the dense correspondence between the pre-edit target image and the clean sample. 

Examples of usage are under `script.sh`. There will be some images that NBB can not find correspondences for (some churches can't be corresponded to domes). In this case, you can use `get_missing.py` to make sure there wasn't something that went terribly wrong, and if it confirms there is no correspondence, we take the edited image as the original clean image. 

To blend two images given their dense correspondences, we use `pyflow/transform.py`. It takes `--src_root` as the path to the clean images, `--target_img` is the **edited** targeted image, `--mask` is the mask used to generate the target image, `--corr_root` as the results directory from NBB, and `--results_dir` is where to put the blended images. `{results_dir}/naive` gives you the copy pasted images without any blurring, `{results_dir}/poisson` uses poisson blending, and `{results_dir}/laplace` is laplace blending, and `warped` is how the target image is warped before copy pasting. 

 